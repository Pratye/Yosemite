<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script type="module" src="https://md-block.verou.me/md-block.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

    <title>Yosemite</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.png') }}">

</head>
<body>
    <nav id="sidebar">
        <div class="float-top">
            <div class="sidebar-controls">
                <button class="new-chat"><i class="fa fa-plus"></i> New chat</button>
<!--                <button class="hide-sidebar"><i class="fa fa-chevron-left"></i></button>-->
            </div>
            <ul class="conversations">
                <li class="grouping">Past Chats</li>
                {% for session in sessions %}
                <li class="active">

                    <button class="conversation-button" data-session-id="{{ session.session_id }}">{{ session.chat_name or 'New Chat' }}</button>
                    <div class="fade"></div>
                    <div class="edit-buttons">
                        <button class="chat-edit" data-session-id="{{ session.session_id }}"><i class="fa fa-edit"></i></button>
                        <button class="delete-chat" data-session-id="{{ session.session_id }}"><i class="fa fa-trash"></i></button>
                    </div>
                    <input type="text" class="rename-input" data-session-id="{{ session.session_id }}" placeholder="Rename chat" style="display: none;">
                </li>
                {% endfor %}
            </ul>
        </div>
        <div class="user-menu">
            <button>
                <i class="user-icon">u</i>
                {{ username }}
                <i class="fa fa-ellipsis dots"></i>
            </button>
            <ul>
<!--                <li><button>My plan</button></li>-->
<!--                <li><button>Custom instructions</button></li>-->
<!--                <li><button>Settings &amp; Beta</button></li>-->
                <li><button id="logout-btn" onclick="logout()">Log out</button></li>
            </ul>
        </div>
    </nav>
    <main>
        <div class="view new-chat-view">
            <div class="logo" >
                Yosemite â›°
            </div>
        </div>

        <div class="conversation-view">
            <!-- Messages will be added here -->
        </div>

        <div id="message-form">
            <div class="message-wrapper">
                <button class="btn" onclick="openPopup()"><span class="material-symbols-outlined">
upload
</span></button>
                <textarea class="message-input" id="message" rows="1" placeholder="Send a message"></textarea>
                <button class="send-button"><i class="fa fa-paper-plane"></i> Send</button>
            </div>
            <div class="disclaimer">Yosemite can make mistakes. Check important info.</div>
        </div>

        <!-- Pop-up for file upload and URL input -->
        <!-- Button to open the pop-up -->


        <!-- Pop-up for file upload and URL input -->
        <div id="popupForm" class="popup">
            <p style="color: white;">Upload File or Add URL</p>

            <!-- Drag and drop area for file upload -->
            <div class="upload-container" id="dropZone" onclick="document.getElementById('fileInput').click()">
                <p id="uploadText" style="margin: 30px;">Drag & Drop files here, or click to browse
                    <br>
                    <p style="color: var(--color-logo)">
                    Suported file types: .pdf, .doc, .docx, .ppt, .pptx, .xlsx, .jpeg, .jpg, .png, .HEIC, .csv, .epub, .md, .msg, .odt, .org, .rtf, .rst, .tsv
                    </p>
                 </p>

            </div>

            <form id="mainForm" enctype="multipart/form-data">
            <!-- Hidden file input -->
            <input type="file" id="fileInput" class="hidden-input" name="file" onchange="handleFileSelect(this)">

            <!-- File name display -->
            <p class="file-name" id="fileName"></p>

            <!-- URL input field -->
            <label for="urlInput" style="color:white;">Or enter Website URL:</label>
            <input type="text" id="urlInput" name="url" placeholder="https://example.com" oninput="toggleFileInput()">

            <!-- Submit button -->
            <button type="button" class="btn_submit" onclick="submitForm()">Submit</button>
            <div class="close-popup" onclick="closePopup()">Close</div>
        </form>
        </div>

        <!-- Custom Alert Box -->
        <div id="customAlert" class="custom-alert">
            <span id="alertMessage"></span>
            <span class="close-btn" onclick="closeAlert()">&times;</span>
        </div>

    </main>
    <script src="./static/script.js"></script>
</body>
</html>
